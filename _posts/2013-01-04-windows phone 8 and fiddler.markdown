---
layout: post
title: "windows phone 8 and fiddler"
date: 2013-01-04 11:06:06 +0100
comments: true
published: true
categories: ["post"]
tags: [".Net", "WP7", "WP8", "Devices"]
alias: ["/blog/post/2013/01/04/Windows-Phone-8-and-Fiddler.aspx", "/blog/post/2013/01/04/windows-phone-8-and-fiddler.aspx"]
author: Nico Vermeir
redirect_from:
 - /blog/post/2013/01/04/Windows-Phone-8-and-Fiddler.aspx
 - /blog/post/2013/01/04/windows-phone-8-and-fiddler.aspx
---
<h2>Fiddler and the WP8 emulator</h2>  <p>Fiddler is a great tool for capturing network traffic. I find it especially useful when I’m working with services. It sniffs out your network traffic and allows you to dig into every incoming or outgoing request. You can even create requests from inside the tool. The tool itself is free to use and can be downloaded from <a title="https://fiddler2.com/fiddler2/" href="https://fiddler2.com/fiddler2/">https://fiddler2.com/fiddler2/</a></p>  <p><a href="http://i49.tinypic.com/6iz6t1.jpg" target="_blank"><img src="http://i49.tinypic.com/6iz6t1.jpg" width="437" height="235" /></a></p>  <p>So how does it work? Fiddler installs a proxy on your machine (default on port 8888). That proxy intercepts all network traffic going from and to the machine it’s installed on. That traffic gets displayed in the Fiddler UI. The proxy captures the traffic, sends it to the application and let the traffic itself pass to the original destination. This image shows the normal client – internet situation (top half) and the situation with Fiddler installed (bottom half).</p>  <p><a href="http://i47.tinypic.com/r1ydg4.jpg" target="_blank"><img src="http://i47.tinypic.com/r1ydg4.jpg" width="441" height="276" /></a></p>  <p>Makes sense? Nothing to difficult about this. What I just explained here is the basic functionality of Fiddler. Only monitoring your local traffic. The Windows Phone 8 emulator runs as a Hyper-V virtual machine, meaning it identifies itself as a separate device on the network. But that’s not really a problem, Fiddler in al its greatness can monitor remote devices as well. Here’s how to enable it.</p>  <p>First, start Fiddler and go to Tools &gt; Fiddler options. Go to tab “Connections” and check the “Allow remote computers to connect” option.</p>  <p><a href="http://i50.tinypic.com/awaowi.jpg" target="_blank"><img src="http://i50.tinypic.com/awaowi.jpg" width="449" height="303" /></a></p>  <p>Click OK, back on the Fiddler main screen, you’ll notice a textbox underneath the list of captured requests (a black one). That’s called the QuickExec box, it can be used to set preferences. In our case we need to add a hostname to our proxy. The hostname we need to add is the one from the Hyper-V host that is running the Windows Phone emulator, your developer machine in other words. Since all traffic from the Windows Phone emulator goes through our developer machines we need to attach Fiddler to our pc. The default localhost connection won’t work so we need to attach the Fiddler proxy to the network name. </p>  <p>In the QuickExec box enter this command</p>  <p><strong>prefs set fiddler.network.proxy.registrationhostname &lt;your computername&gt;</strong></p>  <p><a href="http://i50.tinypic.com/20aphu0.jpg" target="_blank"><img src="http://i50.tinypic.com/20aphu0.jpg" width="428" height="142" /></a></p>  <p>With that done, restart Fiddler and the Windows Phone emulator and behold the emulator’s traffic getting sniffed. As you can see on the screenshot below, if I use the mobile browser in the emulator to go to my blog Fiddler captures all the images, pages, scriptfiles etc. that are getting loaded. If I select one, the user agent clearly points to the Windows Phone 8 browser.</p>  <p><a href="http://i46.tinypic.com/29gn2mb.jpg" target="_blank"><img src="http://i46.tinypic.com/29gn2mb.jpg" width="471" height="252" /></a></p>  <p>Note that it doesn’t just captures the emulator’s traffic, all the localhost traffic is still captured as well.</p>  <p>Keep in mind that if you close Fiddler now there’s a chance that the Windows Phone emulator won’t have network access anymore, that’s because at startup it configured the Fiddler proxy as gateway, closing Fiddler means disabling the proxy. Simply restart the emulator and it should work fine again.</p>  <p>This is all great stuff, but eventually we’ll run into a situation where we need to sniff network traffic but for some reason we can’t use the emulator. With Fiddler we can also sniff the network traffic from an actual Windows Phone device, provided the machine running Fiddler and the Windows Phone are connected to the same network. </p>  <h2>Fiddler and WP8 devices</h2>  <p>To do this, setup Fiddler the same way as we did for the emulator. When that’s done, on you Windows Phone device go to Settings &gt; WiFi. Select the wireless network that your phone is connected to and enable the Proxy. Set the proxy url to the IP address or the hostname of the computer running Fiddler and the port to 8888.</p>  <p><a href="http://i45.tinypic.com/nx9pvk.jpg" target="_blank"><img src="http://i45.tinypic.com/nx9pvk.jpg" width="174" height="290" /></a></p>  <p>Fire up Fiddler, fire up the mobile browser on your phone and be amazed! </p>  <p>If you’re decrypting HTTPS traffic you might need to install the Fiddler certificate on your phone, the browser will prompt you to install it. Before testing your app with HTTPS, try the browser first so the certificate gets installed. Do be aware that every Fiddler installation generates its own certificate (they are self-signed so you might get a security warning, in this case its perfectly safe to ignore that warning) so you might need to install a new one when you use Fiddler on another machine.</p>  <p><a href="http://i47.tinypic.com/14bufti.jpg" target="_blank"><img src="http://i47.tinypic.com/14bufti.jpg" width="179" height="298" /></a></p>  <h2>&#160;</h2>  <h2>Conclusion</h2>  <p>In this post we’ve talked about using Fiddler, a great tool for sniffing and decrypting network requests, with both the Windows Phone 8 emulator and Windows Phone 8 devices. It’s really easy to setup and a great asset when working or developing services.</p>  <p>A few remarks to end this post:</p>  <p> If you ever change your computer’s hostname Fiddler will stop capturing Windows Phone network. Use the <strong>prefs set fiddler.network.proxy.registrationhostname &lt;your computername&gt;</strong> command again in the QuickExec box with the new hostname and Fiddler will happily continue its work.</p>  <p>If you computer is joined to a domain that has IPSEC security setup you will need to ask the administrator to add a IPSEC Boundary Computer exception for your computer.</p>  <p>Happy sniffing!</p>
{% include imported_disclaimer.html %}
